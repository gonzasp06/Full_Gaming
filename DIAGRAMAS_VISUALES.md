# ğŸ¨ DIAGRAMAS VISUALES DEL SISTEMA FULL GAMING

## Ãndice
1. [Arquitectura del Sistema](#arquitectura-del-sistema)
2. [Flujo de Datos](#flujo-de-datos)
3. [Estructura de la Base de Datos](#estructura-de-la-base-de-datos)
4. [Flujo de AutenticaciÃ³n](#flujo-de-autenticaciÃ³n)
5. [Flujo del Carrito de Compras](#flujo-del-carrito-de-compras)
6. [Flujo de Compra Completa](#flujo-de-compra-completa)
7. [OrganizaciÃ³n de Archivos](#organizaciÃ³n-de-archivos)

---

## Arquitectura del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         NAVEGADOR WEB                           â”‚
â”‚                    (Chrome, Firefox, Edge)                      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  HTML    â”‚  â”‚   CSS    â”‚  â”‚Bootstrap â”‚  â”‚JavaScriptâ”‚      â”‚
â”‚  â”‚Templates â”‚  â”‚  Styles  â”‚  â”‚   UI     â”‚  â”‚  AJAX    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/HTTPS
                         â”‚ (Requests: GET, POST)
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVIDOR FLASK                             â”‚
â”‚                     (Python + Flask)                            â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    app.py                             â”‚     â”‚
â”‚  â”‚              (Controlador Principal)                  â”‚     â”‚
â”‚  â”‚                                                       â”‚     â”‚
â”‚  â”‚  @app.route('/')          â†’ CatÃ¡logo                 â”‚     â”‚
â”‚  â”‚  @app.route('/producto')  â†’ Detalle                  â”‚     â”‚
â”‚  â”‚  @app.route('/carrito')   â†’ Carrito                  â”‚     â”‚
â”‚  â”‚  @app.route('/cuenta')    â†’ Login                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                      â”‚                                          â”‚
â”‚                      â”‚ Usa Servicios                            â”‚
â”‚                      â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚              CAPA DE SERVICIOS                       â”‚      â”‚
â”‚  â”‚                                                      â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚  â”‚  â”‚  Producto   â”‚  â”‚  Usuario    â”‚  â”‚  Carrito   â”‚ â”‚      â”‚
â”‚  â”‚  â”‚  Service    â”‚  â”‚  Service    â”‚  â”‚  Service   â”‚ â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚  â”‚                                                      â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚      â”‚
â”‚  â”‚  â”‚  Pedido     â”‚  â”‚   Admin     â”‚                  â”‚      â”‚
â”‚  â”‚  â”‚  Service    â”‚  â”‚  Manager    â”‚                  â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚               â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”‚ SQL Queries
                â”‚ (SELECT, INSERT, UPDATE, DELETE)
                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BASE DE DATOS                            â”‚
â”‚                         MySQL                                 â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚producto  â”‚  â”‚ usuario  â”‚  â”‚ pedidos  â”‚  â”‚pedido_itemsâ”‚  â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚            â”‚  â”‚
â”‚  â”‚ â€¢id      â”‚  â”‚ â€¢id      â”‚  â”‚ â€¢id      â”‚  â”‚ â€¢id        â”‚  â”‚
â”‚  â”‚ â€¢nombre  â”‚  â”‚ â€¢nombre  â”‚  â”‚ â€¢user_id â”‚  â”‚ â€¢pedido_id â”‚  â”‚
â”‚  â”‚ â€¢precio  â”‚  â”‚ â€¢email   â”‚  â”‚ â€¢total   â”‚  â”‚ â€¢prod_id   â”‚  â”‚
â”‚  â”‚ â€¢stock   â”‚  â”‚ â€¢pass    â”‚  â”‚ â€¢fecha   â”‚  â”‚ â€¢cantidad  â”‚  â”‚
â”‚  â”‚ â€¢foto    â”‚  â”‚ â€¢is_adminâ”‚  â”‚          â”‚  â”‚ â€¢precio    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de Datos

### Request-Response Cycle

```
1. USUARIO HACE CLICK EN "AGREGAR AL CARRITO"
   â”‚
   â”‚  [navegador]
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JavaScript ejecuta fetch()          â”‚
â”‚  POST /agregar_carrito/18            â”‚
â”‚  Body: {cantidad: 2}                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ HTTP Request
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flask recibe request                â”‚
â”‚  @app.route('/agregar_carrito/<id>') â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 1. Llama ProductoService
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ProductoService.obtener_por_id(18)  â”‚
â”‚  Ejecuta: SELECT * FROM producto     â”‚
â”‚           WHERE id = 18              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 2. MySQL retorna datos
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flask valida stock disponible       â”‚
â”‚  if producto[5] > 0: âœ“               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 3. Llama CarritoService
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CarritoService.agregar_item(18, 2)  â”‚
â”‚  session['carrito']['18'] = 2        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 4. Retorna respuesta
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flask genera JSON response          â”‚
â”‚  {"ok": true, "mensaje": "OK"}       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ HTTP Response
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JavaScript recibe respuesta         â”‚
â”‚  alert("Producto agregado")          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Estructura de la Base de Datos

### Diagrama ER (Entidad-RelaciÃ³n)

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     usuario      â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ PK â”‚ idusuario   â”‚
                    â”‚    â”‚ nombre      â”‚
                    â”‚    â”‚ apellido    â”‚
                    â”‚ UK â”‚ email       â”‚
                    â”‚    â”‚ contraseÃ±a  â”‚
                    â”‚    â”‚ is_admin    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ 1:N (Un usuario tiene muchos pedidos)
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     pedidos      â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ PK â”‚ id          â”‚
                    â”‚ FK â”‚ usuario_id  â”‚
                    â”‚    â”‚ email       â”‚
                    â”‚    â”‚ total       â”‚
                    â”‚    â”‚ estado      â”‚
                    â”‚    â”‚ fecha       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ 1:N (Un pedido tiene muchos items)
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  pedido_items    â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ PK â”‚ id          â”‚
                    â”‚ FK â”‚ pedido_id   â”‚
                    â”‚ FK â”‚ producto_id â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    â”‚ cantidad    â”‚          â”‚
                    â”‚    â”‚ precio      â”‚          â”‚ N:1
                    â”‚    â”‚ subtotal    â”‚          â”‚ (Muchos items
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  referencian
                                                  â”‚  un producto)
                                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    producto    â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ PK â”‚ id        â”‚
            â”‚    â”‚ nombre    â”‚
            â”‚    â”‚ descripcion
            â”‚    â”‚ categoria â”‚
            â”‚    â”‚ precio    â”‚
            â”‚    â”‚ cantidad  â”‚ â† Stock disponible
            â”‚    â”‚ foto      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Leyenda:
PK = Primary Key (Clave Primaria)
FK = Foreign Key (Clave ForÃ¡nea)
UK = Unique Key (Clave Ãšnica)
1:N = RelaciÃ³n uno a muchos
```

### Ejemplo de Datos Relacionados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ usuario (id: 14)                                                â”‚
â”‚ â”œâ”€ nombre: "Juan"                                               â”‚
â”‚ â”œâ”€ email: "juan@example.com"                                    â”‚
â”‚ â””â”€ pedidos:                                                     â”‚
â”‚     â”‚                                                            â”‚
â”‚     â”œâ”€ pedido (id: 42)                                          â”‚
â”‚     â”‚   â”œâ”€ total: 1,178,357.00                                  â”‚
â”‚     â”‚   â”œâ”€ fecha: "2024-04-17 10:30:00"                        â”‚
â”‚     â”‚   â””â”€ items:                                               â”‚
â”‚     â”‚       â”‚                                                    â”‚
â”‚     â”‚       â”œâ”€ pedido_item (id: 100)                            â”‚
â”‚     â”‚       â”‚   â”œâ”€ producto_id: 18 (TV Philips)                â”‚
â”‚     â”‚       â”‚   â”œâ”€ cantidad: 2                                  â”‚
â”‚     â”‚       â”‚   â”œâ”€ precio: 524,699.00                           â”‚
â”‚     â”‚       â”‚   â””â”€ subtotal: 1,049,398.00                       â”‚
â”‚     â”‚       â”‚                                                    â”‚
â”‚     â”‚       â””â”€ pedido_item (id: 101)                            â”‚
â”‚     â”‚           â”œâ”€ producto_id: 19 (Parlante)                  â”‚
â”‚     â”‚           â”œâ”€ cantidad: 1                                  â”‚
â”‚     â”‚           â”œâ”€ precio: 128,959.00                           â”‚
â”‚     â”‚           â””â”€ subtotal: 128,959.00                         â”‚
â”‚     â”‚                                                            â”‚
â”‚     â””â”€ pedido (id: 45)                                          â”‚
â”‚         â”œâ”€ total: 89,999.00                                     â”‚
â”‚         â”œâ”€ fecha: "2024-04-18 15:00:00"                        â”‚
â”‚         â””â”€ items:                                               â”‚
â”‚             â””â”€ pedido_item (id: 105)                            â”‚
â”‚                 â”œâ”€ producto_id: 42 (Smartwatch)                â”‚
â”‚                 â”œâ”€ cantidad: 1                                  â”‚
â”‚                 â”œâ”€ precio: 89,999.00                            â”‚
â”‚                 â””â”€ subtotal: 89,999.00                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de AutenticaciÃ³n

### Registro de Usuario

```
PASO 1: Usuario completa formulario
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nombre: Juan                   â”‚
â”‚  Apellido: PÃ©rez               â”‚
â”‚  Email: juan@example.com        â”‚
â”‚  ContraseÃ±a: miPass123          â”‚
â”‚  [Registrarse]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 2: POST /cargar_usuario
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UsuarioService.crear_usuario()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 3: Encriptar contraseÃ±a
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bcrypt.hashpw("miPass123", salt)        â”‚
â”‚                                          â”‚
â”‚  Entrada: "miPass123"                    â”‚
â”‚  Salida:  "$2b$12$VBLLKIlD4P4aL..."     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 4: Guardar en BD
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INSERT INTO usuario                    â”‚
â”‚  (nombre, apellido, email, contraseÃ±a)  â”‚
â”‚  VALUES ('Juan', 'PÃ©rez',               â”‚
â”‚          'juan@example.com',            â”‚
â”‚          '$2b$12$VBLLKIlD4P4aL...')     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 5: Respuesta
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  {"mensaje": "Cuenta creada"}â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Login de Usuario

```
PASO 1: Usuario ingresa credenciales
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Email: juan@example.com        â”‚
â”‚  ContraseÃ±a: miPass123          â”‚
â”‚  [Iniciar SesiÃ³n]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 2: POST /cuenta
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UsuarioService.login()        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 3: Buscar usuario en BD
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SELECT * FROM usuario               â”‚
â”‚  WHERE email = 'juan@example.com'    â”‚
â”‚                                      â”‚
â”‚  Resultado:                          â”‚
â”‚  {                                   â”‚
â”‚    id: 14,                           â”‚
â”‚    nombre: 'Juan',                   â”‚
â”‚    email: 'juan@example.com',        â”‚
â”‚    contraseÃ±a: '$2b$12$VBLL...',    â”‚
â”‚    is_admin: 0                       â”‚
â”‚  }                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 4: Verificar contraseÃ±a
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bcrypt.checkpw(                       â”‚
â”‚    "miPass123",                        â”‚
â”‚    "$2b$12$VBLL..."                   â”‚
â”‚  )                                     â”‚
â”‚                                        â”‚
â”‚  Â¿Coincide? âœ“ True                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 5: Crear sesiÃ³n
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  session['usuario_id'] = 14            â”‚
â”‚  session['usuario_email'] = 'juan@...' â”‚
â”‚  session['usuario_nombre'] = 'Juan'    â”‚
â”‚  session['es_admin'] = 0               â”‚
â”‚  session.permanent = True              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
PASO 6: Respuesta
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  {"mensaje": "Login exitoso"}   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULTADO:
Usuario autenticado por 7 dÃ­as
Puede acceder a rutas protegidas
Carrito persiste entre sesiones
```

---

## Flujo del Carrito de Compras

### Estado del Carrito en SesiÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SESSION (Cookie)                      â”‚
â”‚                                                          â”‚
â”‚  {                                                       â”‚
â”‚    'usuario_id': 14,                                     â”‚
â”‚    'usuario_email': 'juan@example.com',                  â”‚
â”‚    'es_admin': 0,                                        â”‚
â”‚    'carrito': {                                          â”‚
â”‚      '18': 2,    â—„â”€â”€ TV Philips Ã— 2 unidades           â”‚
â”‚      '19': 1,    â—„â”€â”€ Parlante Ã— 1 unidad               â”‚
â”‚      '20': 3     â—„â”€â”€ Monitor Ã— 3 unidades              â”‚
â”‚    }                                                     â”‚
â”‚  }                                                       â”‚
â”‚                                                          â”‚
â”‚  Almacenado en: Cookie cifrada en el navegador          â”‚
â”‚  DuraciÃ³n: 7 dÃ­as (configurable)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Agregar Producto al Carrito

```
Estado ANTES:
session['carrito'] = {'19': 1, '20': 3}

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usuario agrega producto ID: 18  â”‚
â”‚ Cantidad: 2                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CarritoService.agregar_item(18, 2)   â”‚
â”‚                                      â”‚
â”‚ if '18' in carrito:                  â”‚
â”‚   carrito['18'] += 2                 â”‚
â”‚ else:                                â”‚
â”‚   carrito['18'] = 2  â—„â”€â”€ Ejecuta estoâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼

Estado DESPUÃ‰S:
session['carrito'] = {'19': 1, '20': 3, '18': 2}
```

### Ver Carrito con Detalles

```
session['carrito'] = {'18': 2, '19': 1}

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CarritoService.obtener_items_detalle()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
Para cada item en carrito:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ProductoService.obtener_por_id(18)              â”‚
â”‚ â”œâ”€ SELECT * FROM producto WHERE id = 18        â”‚
â”‚ â””â”€ Retorna: (18, 'TV Philips', ..., 524699, ..)â”‚
â”‚                                                 â”‚
â”‚ Calcula:                                        â”‚
â”‚ â”œâ”€ precio: 524699.00                           â”‚
â”‚ â”œâ”€ cantidad: 2                                 â”‚
â”‚ â””â”€ subtotal: 524699 Ã— 2 = 1,049,398           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ProductoService.obtener_por_id(19)              â”‚
â”‚ â”œâ”€ SELECT * FROM producto WHERE id = 19        â”‚
â”‚ â””â”€ Retorna: (19, 'Parlante', ..., 128959, ...)  â”‚
â”‚                                                 â”‚
â”‚ Calcula:                                        â”‚
â”‚ â”œâ”€ precio: 128959.00                           â”‚
â”‚ â”œâ”€ cantidad: 1                                 â”‚
â”‚ â””â”€ subtotal: 128959 Ã— 1 = 128,959             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
Resultado Final:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ items = [                                        â”‚
â”‚   {                                              â”‚
â”‚     id: 18,                                      â”‚
â”‚     nombre: 'TV Philips 4K 50"',                â”‚
â”‚     precio: 524699.00,                           â”‚
â”‚     cantidad: 2,                                 â”‚
â”‚     subtotal: 1049398.00,                        â”‚
â”‚     foto: 'static/uploads/tv.jpg'               â”‚
â”‚   },                                             â”‚
â”‚   {                                              â”‚
â”‚     id: 19,                                      â”‚
â”‚     nombre: 'Parlante Bluetooth',               â”‚
â”‚     precio: 128959.00,                           â”‚
â”‚     cantidad: 1,                                 â”‚
â”‚     subtotal: 128959.00,                         â”‚
â”‚     foto: 'static/uploads/parlante.jpg'         â”‚
â”‚   }                                              â”‚
â”‚ ]                                                â”‚
â”‚                                                  â”‚
â”‚ total = 1,178,357.00                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de Compra Completa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INICIO: Usuario tiene productos en carrito                 â”‚
â”‚ session['carrito'] = {'18': 2, '19': 1}                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usuario click "Confirmar Compra"                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /procesar_compra                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Obtener datos del carrito                                â”‚
â”‚    items_compra = [                                         â”‚
â”‚      {producto_id: 18, cantidad: 2, precio: 524699, ...},  â”‚
â”‚      {producto_id: 19, cantidad: 1, precio: 128959, ...}   â”‚
â”‚    ]                                                        â”‚
â”‚    total = 1,178,357.00                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Crear pedido en BD                                       â”‚
â”‚    PedidoService.crear_pedido()                             â”‚
â”‚                                                             â”‚
â”‚    INSERT INTO pedidos                                      â”‚
â”‚    (usuario_id, email, total, estado)                       â”‚
â”‚    VALUES (14, 'juan@...', 1178357, 'completado')          â”‚
â”‚                                                             â”‚
â”‚    pedido_id generado: 42                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Crear items del pedido                                   â”‚
â”‚                                                             â”‚
â”‚    INSERT INTO pedido_items                                 â”‚
â”‚    (pedido_id, producto_id, cantidad, precio, subtotal)     â”‚
â”‚    VALUES (42, 18, 2, 524699, 1049398)                     â”‚
â”‚                                                             â”‚
â”‚    INSERT INTO pedido_items                                 â”‚
â”‚    (pedido_id, producto_id, cantidad, precio, subtotal)     â”‚
â”‚    VALUES (42, 19, 1, 128959, 128959)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Restar stock de productos                                â”‚
â”‚                                                             â”‚
â”‚    UPDATE producto                                          â”‚
â”‚    SET cantidad = cantidad - 2                              â”‚
â”‚    WHERE id = 18                                            â”‚
â”‚    (Stock TV: 10 â†’ 8)                                       â”‚
â”‚                                                             â”‚
â”‚    UPDATE producto                                          â”‚
â”‚    SET cantidad = cantidad - 1                              â”‚
â”‚    WHERE id = 19                                            â”‚
â”‚    (Stock Parlante: 5 â†’ 4)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Vaciar carrito                                           â”‚
â”‚    session['carrito'] = {}                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Retornar confirmaciÃ³n                                    â”‚
â”‚    {                                                        â”‚
â”‚      "ok": true,                                            â”‚
â”‚      "pedido_id": 42,                                       â”‚
â”‚      "total": 1178357,                                      â”‚
â”‚      "mensaje": "Compra realizada exitosamente"            â”‚
â”‚    }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FIN: Compra completada                                      â”‚
â”‚ âœ“ Pedido registrado en BD                                   â”‚
â”‚ âœ“ Stock actualizado                                         â”‚
â”‚ âœ“ Carrito vaciado                                           â”‚
â”‚ âœ“ Usuario recibe confirmaciÃ³n                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## OrganizaciÃ³n de Archivos

```
Full_Gaming/
â”‚
â”œâ”€â”€ ğŸ“„ app.py                         â† Controlador principal (Flask)
â”‚                                        â€¢ Rutas HTTP
â”‚                                        â€¢ Instancia servicios
â”‚                                        â€¢ Maneja requests/responses
â”‚
â”œâ”€â”€ ğŸ“„ database.py                    â† ConfiguraciÃ³n de MySQL
â”‚                                        â€¢ conectar_base_datos()
â”‚
â”œâ”€â”€ ğŸ“„ crear_admin.py                 â† Script para crear admins
â”‚
â”œâ”€â”€ ğŸ“„ requirements.txt               â† Dependencias Python
â”‚                                        â€¢ Flask
â”‚                                        â€¢ bcrypt
â”‚                                        â€¢ mysql-connector-python
â”‚
â”œâ”€â”€ ğŸ“„ README.md                      â† DocumentaciÃ³n general
â”œâ”€â”€ ğŸ“„ DOCUMENTACION_SISTEMA.md       â† DocumentaciÃ³n completa
â”œâ”€â”€ ğŸ“„ GUIA_RAPIDA_EXAMEN.md          â† GuÃ­a rÃ¡pida de referencia
â”œâ”€â”€ ğŸ“„ EJEMPLOS_PRACTICOS.md          â† Ejemplos con cÃ³digo
â”œâ”€â”€ ğŸ“„ DIAGRAMAS_VISUALES.md          â† Este archivo
â”‚
â”œâ”€â”€ ğŸ“‚ services/                      â† Capa de servicios (LÃ³gica)
â”‚   â”œâ”€â”€ producto_service.py              â€¢ CRUD de productos
â”‚   â”œâ”€â”€ usuario_service.py               â€¢ Registro y login
â”‚   â”œâ”€â”€ carrito_service.py               â€¢ GestiÃ³n de carrito
â”‚   â”œâ”€â”€ pedido_service.py                â€¢ Procesar compras
â”‚   â””â”€â”€ admin_manager.py                 â€¢ Control de permisos
â”‚
â”œâ”€â”€ ğŸ“‚ templates/                     â† Vistas HTML (PresentaciÃ³n)
â”‚   â”œâ”€â”€ index.html                       â€¢ CatÃ¡logo principal
â”‚   â”œâ”€â”€ producto_detalle.html            â€¢ Detalle de producto
â”‚   â”œâ”€â”€ carrito.html                     â€¢ Vista del carrito
â”‚   â”œâ”€â”€ acceso.html                      â€¢ Login/Registro
â”‚   â”œâ”€â”€ f_nuevo_usuario.html             â€¢ Formulario registro
â”‚   â”œâ”€â”€ formulario_carga_producto.html   â€¢ Agregar producto (admin)
â”‚   â”œâ”€â”€ editar_producto.html             â€¢ Editar producto (admin)
â”‚   â”œâ”€â”€ gestion_productos.html           â€¢ Lista productos (admin)
â”‚   â”œâ”€â”€ categoria.html                   â€¢ Filtro por categorÃ­a
â”‚   â”œâ”€â”€ resultado_busqueda.html          â€¢ Resultados de bÃºsqueda
â”‚   â”œâ”€â”€ navbar.html                      â€¢ MenÃº de navegaciÃ³n
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ ğŸ“‚ static/                        â† Archivos estÃ¡ticos
    â”œâ”€â”€ ğŸ“‚ uploads/                      â€¢ ImÃ¡genes de productos
    â”‚   â”œâ”€â”€ tv-philips.jpg
    â”‚   â”œâ”€â”€ parlante-bluetooth.jpg
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ ğŸ“‚ css/                          â€¢ Estilos CSS
    â””â”€â”€ ğŸ“‚ js/                           â€¢ JavaScript

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PatrÃ³n de DiseÃ±o: MVC (Modelo-Vista-Controlador)        â”‚
â”‚                                                          â”‚
â”‚ â€¢ MODELO:       services/ + MySQL                       â”‚
â”‚ â€¢ VISTA:        templates/ (HTML)                       â”‚
â”‚ â€¢ CONTROLADOR:  app.py (rutas Flask)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ComparaciÃ³n: Con Servicios vs Sin Servicios

### âŒ SIN Servicios (Todo en app.py)

```python
@app.route('/productos')
def listar_productos():
    # LÃ³gica mezclada con controlador
    conexion = mysql.connector.connect(...)
    cursor = conexion.cursor()
    cursor.execute("SELECT * FROM producto")
    productos = cursor.fetchall()
    cursor.close()
    conexion.close()
    return render_template('productos.html', productos=productos)
```

**Problemas:**
- âŒ DifÃ­cil de mantener
- âŒ No reutilizable
- âŒ DifÃ­cil de testear
- âŒ CÃ³digo repetitivo

### âœ… CON Servicios (Arquitectura Limpia)

```python
# En app.py (Controlador)
@app.route('/productos')
def listar_productos():
    service = ProductoService()
    productos = service.obtener_todos()
    return render_template('productos.html', productos=productos)

# En services/producto_service.py (Modelo)
class ProductoService:
    def obtener_todos(self):
        cursor = self.conexion.cursor()
        cursor.execute("SELECT * FROM producto")
        productos = cursor.fetchall()
        cursor.close()
        return productos
```

**Ventajas:**
- âœ… CÃ³digo organizado
- âœ… Reutilizable en mÃºltiples rutas
- âœ… FÃ¡cil de testear
- âœ… SeparaciÃ³n de responsabilidades

---

## Ciclo de Vida de una SesiÃ³n

```
T=0: Usuario abre navegador
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {}             â”‚ â† VacÃ­a
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T=1: Usuario se loguea
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {              â”‚
â”‚   'usuario_id': 14,      â”‚
â”‚   'usuario_email': '...' â”‚
â”‚ }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T=2: Usuario agrega al carrito
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {              â”‚
â”‚   'usuario_id': 14,      â”‚
â”‚   'usuario_email': '...',â”‚
â”‚   'carrito': {           â”‚
â”‚     '18': 2              â”‚
â”‚   }                      â”‚
â”‚ }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T=3: Usuario agrega mÃ¡s productos
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {              â”‚
â”‚   'usuario_id': 14,      â”‚
â”‚   'usuario_email': '...',â”‚
â”‚   'carrito': {           â”‚
â”‚     '18': 2,             â”‚
â”‚     '19': 1              â”‚
â”‚   }                      â”‚
â”‚ }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T=4: Usuario confirma compra
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {              â”‚
â”‚   'usuario_id': 14,      â”‚
â”‚   'usuario_email': '...',â”‚
â”‚   'carrito': {}          â”‚ â† Vaciado
â”‚ }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T=5: Usuario cierra navegador
â€¢ SesiÃ³n persiste durante 7 dÃ­as
â€¢ Cookie guardada en disco

T=6: Usuario vuelve al dÃ­a siguiente
â€¢ Flask lee cookie
â€¢ SesiÃ³n restaurada automÃ¡ticamente
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {              â”‚
â”‚   'usuario_id': 14,      â”‚
â”‚   'usuario_email': '...',â”‚
â”‚   'carrito': {}          â”‚
â”‚ }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â€¢ Usuario sigue logueado âœ“

T=7: Usuario hace logout
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session = {}             â”‚ â† Vaciada completamente
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â€¢ Cookie eliminada
```

---

Estos diagramas te ayudarÃ¡n a visualizar y explicar cÃ³mo funciona cada parte del sistema. Â¡Ãšsalos en tu examen! ğŸ¯
